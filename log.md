## [2025-12-11] Renderer refactor and docs

- `RugbyTimerView` now delegates all score/timer/card drawing and layout math to `RugbyTimerRenderer`, keeping the view focused on state updates and overlays while ensuring the countdown positioning math stays centralized.
- Added inline documentation around the renderer's candidate/limit/min timers so future agents understand why `countdownY`, `stateY`, and `hintY` stay spaced based on the card stack and reserved state area.
- Updated `README.md`, `project_technical_document.md`, and `AGENTS.md` to mention the renderer helper and the documentation expectations; no manual compile was run because the environment is edit-only.

## [2025-12-12] Timer/persistence/overlay modules

- Pulled the scoring overlay drawing, countdown math, and haptics into `RugbyTimerTiming.mc`, so the update loop sits outside the view and just orchestrates what state changes happen.
- Created `RugbyTimerPersistence.mc` for `saveState`, `loadSavedState`, and `finalizeGameData`, keeping the view’s persistence logic centralized and shareable.
- Added `RugbyTimerOverlay.mc` to draw the inline conversion/penalty/kickoff overlay, handle hints, and keep the view focused on state updates, plus noted the new helpers in `AGENTS.md` and `project_technical_document.md`.

## [2025-12-31] Countdown overlay polish

- The inline overlay now labels the primary countdown timer, keeps it white, and places the conversion/kickoff/penalty timer squarely in the middle so the referee sees both clocks.
- The special timer confirmation text is larger and still appears briefly when the referee confirms a conversion.

## [2025-12-12] Modular cards and event log helpers

- Created `RugbyTimerCards.mc` to house the yellow/red timer math, numbering helpers, and card-stack resets so the view no longer kept that entire block of logic.
- Added `RugbyTimerEventLog.mc` to format/export the event log text and keep the `EVENT_LOG` wiring out of the main view; the view now just orchestrates the helper and a few thin wrappers.
- Updated the documentation to call out the new helper modules so future contributors know where the card and log behaviors live.

## [2025-12-28] Special timer alert

- Added a 15-second vibration for conversion/penalty/kickoff countdowns so referees are alerted ahead of the kick window.
- Reset the alert flag whenever those timers start so the notification only fires once per phase.

## [2025-12-29] Conversion overlay shortcuts

- When the conversion overlay is visible, the UP button logs a successful kick and adds two points while the DOWN button records a miss, and the onscreen hint updates to remind the referee which buttons perform which action.
- The overlay now renders the conversion countdown in the center (with the main countdown above it, both using the same high-contrast color) and flips the hint text order so the DOWN prompt appears before UP, matching the new layout focus.

## [2025-12-28] Special timer screen and save option

- Save Game now appears in the Exit dialog, writing the current match summary via `saveGame()` so referees can capture the state without ending play.
- Conversion/Kickoff/Penalty states now display the label and countdown as an inline overlay drawn over the scoreboard; the overlay closes automatically before each scoreboard interaction while maintaining the existing UP/DOWN shortcuts.

## [2025-12-30] Conversion overlay countdown & confirmation

- The overlay now shows the running countdown timer above the conversion/kickoff/penalty label so referees retain visibility into the main clock while the special timer is active.
- Registering a conversion via the overlay’s UP button shows “Conversion recorded” on-screen briefly to confirm the score update.

## [2025-12-28] Protect countdown layout

- Added inline documentation for the timer stack math in `source/RugbyTimerView.mc` and clamped `countdownY` to keep the big clock away from the state/hint block while still staying above the card timers.
- Noted the adaptive timer geometry and multi-platform coverage in `project_technical_document.md` and `README.md` so future agents understand the device scope and spacing guarantees.

## [2025-12-27] Highlight conversion text



- Added cover.jpg (512x512, <300 KB) for the Connect IQ Store listing so the app has a compliant cover image alongside the launcher icon.







- Rendered the CONVERSION/KICKOFF/PENALTY labels in high-contrast red to keep them legible against the countdown display.





## [2025-12-27] Avoid timer overlap





- Raised the state text when the countdown timer is high so the conversion/penalty/KICKOFF captions never intersect the white countdown digits; the computed `stateY` and `hintY` now depend on the adjustable `countdownY`.





## [2025-12-27] Trim manifest targets





- Removed the unsupported Forerunner/Venu/Instinct product IDs because the SDK rejected them and documented that the app currently targets Fenix 6/7 plus Epix/Venu in the README.





## [2025-12-26] Expanded product list





- Added the Fenix 7/7S families plus Epix, Forerunner 745/945/255/955, Venu 2/3, and Instinct 2 identifiers to `manifest.xml` and noted the expanded coverage in `README.md` so the app can build for more Garmin watches.





## [2025-12-26] Launcher icon swap





- Replaced the 40?40 PNG launcher icon with `icon.jpg` and pointed `resources/drawables/drawables.xml` at it so the watch delivers the requested asset.





# Session Log





## [2025-12-24] Multi-platform readiness





- Added Fenix 7, Epix, Forerunner 745/945, and Venu 2 to `manifest.xml`, refreshed `README.md`, and noted the wider device coverage so branches can target additional watch families beyond the Fenix 6 lineup.





## [2025-12-24] Pause countdown in set-piece states





- Select toggles pause/resume even during conversions, penalties, and kickoff so the countdown timer can be frozen while those special windows run.





# Session Log





## [2025-12-23] Card counter persistence





- Ensured yellow/red card counters persist via `cardId` metadata, tracked total tallies per team, and reset the timers plus totals when a match finishes so the Y# labels always reflect the total cards issued rather than whether an earlier timer is active.





## [2025-12-22] Event Log relocation





- Moved the Event Log entry out of the main menu and into the Back/Exit menu so referees can access it via the BACK/LAP dialog while the game is running, and hooked the Exit menu item up to `view.showEventLog()`.





## [2025-12-10] Timer layout and docs





- Documented the timer geometry (game clock vs countdown vs card stack) and ensured yellow timer dictionaries carry their `Y#` labels so card logic stays predictable while the running game timer keeps counting even when the countdown is paused.



- Added the 40x40 launcher icon, refreshed `resources/drawables/drawables.xml`, and updated `AGENTS.md` and `project_technical_document.md` so contributors understand the layout and activity recording behavior.



- Verified the build via `monkeyc -f monkey.jungle -o bin\rugbytimer.prg -y developer_key -d fenix6`.





- Shifted the countdown timer above the card stack and capped its position to stay clear of the "PAUSED" prompt, ensuring the card and hint blocks never overlap the primary clock readout.



- Added a kickoff shortcut so the scoreboard button clears the kickoff timer and immediately resumes normal play, keeping the UI responsive during restart sequences.



- Added a menu-driven Event Log that records score/card timestamps and a "Save Log" action that writes the human-readable timeline to Storage for sharing after the match.



- Cleared card timers and red/yellow state whenever a game ends or is reset so stale discipline indicators cannot linger on subsequent matches.







## [2025-12-11] Score Spacing Fix































- Lowered the tries indicators in `source/RugbyTimerView.mc` so they no longer overlap the main score digits on the Fenix 6 layout.































































## [2025-12-12] Try Placement Refinement































- Shifted `triesY` to `height * 0.36` in `source/RugbyTimerView.mc` to add more breathing room under the scores and keep the try text clear of the digits.































- Updated `triesY` to sit just below the half indicator and switched to a centered `homeT/awayT` string so the try info lives between the scores without duplicating text on each side.































































## [2025-12-13] Revert card/main timer layout































- Rolled the card timer / main timer layout back to the pre-layout-refactor implementation so the spacing resembles the earlier stable state, only keeping the centered `homeT / awayT` text beneath the half indicator.































































## [2025-12-14] Swap timer roles































- Flipped the main/secondary timer text so the countdown timer now occupies the primary (white) position while the game clock moves to the lower slot with the dim/red accent color.































































## [2025-12-15] Keep gameTimer running when countdown pauses































- Adjusted `updateGame` so `gameTime` keeps counting even while countdown actions are suspended (e.g., paused), while `countdownRemaining` only ticks during active phases.































































## [2025-12-16] Cap card timers & yellow warning































- Display-only the first two yellow timers per side so extras keep tracking silently until earlier timers finish, then reveal their remaining time once space frees up.































- Added a one-time vibration whenever any yellow timer drops below 10 seconds so the referee hears the countdown even when watching another part of the screen.































- Preserved each yellow entryâ€™s `Y#` label so replacing a card that was hidden still shows the same identifier when it finally appears.































































































## [2025-12-17] Fix label parsing































- Replaced the unsupported `substr` call in `parseLabelNumber` with a manual loop that drops the leading “Y”, preventing the undefined symbol build error on Fenix 6.















































































## [2025-12-18] Clarify timing math















- Documented what `timerY`, `countdownY`, and the card stack offset calculations represent so future contributors understand how card/padding adjustments affect the running timers.







































## [2025-12-19] Expand inline documentation







- Added concise comments before initialization, timer math, scoring/card helpers, persistence, and recording sections so the intent is clear for future maintainers.



















## [2025-12-20] Conversion button shortcuts



- Score/card hardware buttons now double as conversion decisions when the conversion timer is running, so the correct team records a made kick or the conversion timer is terminated on a miss.



- Introduced `conversionTeam` state persistence to remember which side triggered the conversion, keeping the buttons deterministic through loads/resumes.









## [2025-12-21] Decouple timers

- Moved the running game timer above the “Half #” label and kept the countdown clock down below with its own position logic so the two clocks stay separate.



## [2025-12-10] Layout Resilience































- Reworked `RugbyTimerView` so the half text, tries, and timers position themselves without overlapping even when multiple card timers are active, and card timers now space dynamically below the main clocks.































- Noted the adaptive layout strategy in `project_technical_document.md` so future contributors understand the spacing guarantees.































- Rebuilt with `monkeyc` to confirm the refreshed layout compiles cleanly for the Fenix 6.































































## [2025-10-31] Feature/Enhancement Summary































- Added persistent state storage and final match summary for reuse by future agents.































- Reworked UI to display multiple yellow/red timers with numbering, auto shift main timers to avoid overlap, and maintain layout across device resolutions.































- Introduced card dialog via hardware buttons (up/down), conversion-specific score options, and pause clock capability.































- Added 30-second countdown alert via Attention vibrate profile and ensured timers keep running during conversion/penalty states.































- Documented project in `project_technical_document.md` for onboarding future LLM collaborators.



































- Ensured kickoff states keep updating countdownRemaining while their special countdown window runs so the main timer never freezes during conversions, penalties, or kickoff phases.





- Added a menu-driven Event Log that records score/card timestamps and a "Save Log" action that writes the human-readable timeline to Storage for sharing after the match.

- Fixed the exit menu invocation so selecting Event Log pops the dialog before pushing the log view, ensuring the log actually appears instead of being popped immediately.
### 2025-12-11 19:34:32 - Build Successful and Verification Steps\n\n- The application built successfully using the Connect IQ SDK path provided by the user and the developer key.\n- The following command was used for building:\n  \\\\n  \
C:\\Users\\aliel\\AppData\\Roaming\\Garmin\\ConnectIQ\\Sdks\\connectiq-sdk-win-8.3.0-2025-09-22-5813687a0\\bin\\monkeyc.bat\ -f monkey.jungle -o bin\\rugbytimer.prg -y \c:\\Users\\aliel\\Projects\\rugby-timer\\developer_key\ -d fenix6\n  \\\\n- **Manual Verification Steps (to be performed on Fenix 6 simulator):**\n  1. Launch the simulator: Navigate to your Connect IQ SDK installation directory and run \in\\simulator.exe\.\n  2. Load the application: In the simulator, go to \File > Open .PRG\ and select \C:\\Users\\aliel\\Projects\\rugby-timer\\bin\\rugbytimer.prg\.\n  3. **Initial State Verification:**\n     - Confirm the initial screen displays \Ready
to
start\.\n     - Check if the \Game
Type\ prompt appears. Select \Rugby
7s\ or \Rugby
15s\.\n  4. **Game Workflow Verification:**\n     - **Start Game:** Press the \Select\ button (usually Enter key or middle-right button on simulator) to start the game. Confirm the timer starts counting up and the state changes to \PLAYING\.\n     - **Score a Try:** Use the \Up\ or \Down\ buttons to navigate to the score menu (if available, or trigger via menu if configured). Record a try for Home or Away. Observe the score updating and the conversion timer (if enabled) appearing.\n     - **Conversion:** For the conversion timer, verify \UP:
Success
DOWN:
Miss\ hints. Test both success and miss scenarios.\n     - **Penalty/Drop Goal:** Record a Penalty or Drop Goal. Observe score updates.\n     - **Yellow/Red Cards:** Issue Yellow and Red cards. Verify the card timers appear and count down correctly. Check the permanent red card behavior for 7s.\n     - **Pause/Resume:** Pause the game (via \Select\ or menu) and then resume. Confirm game time pauses and resumes correctly.\n     - **Half Time/End Game:** Advance the game to half-time and then to end-game. Verify transitions and score resets (if applicable).\n  5. **Settings Verification:**\n     - Access the settings menu (usually long-press \Menu\ button).\n     - Change game type, half timer, conversion/penalty times, and lock on start. Confirm settings are applied and persist.\n  6. **Event Log:** Access the event log and confirm recorded events are visible.\n
